"use strict";(self.webpackChunkcelestia_docs=self.webpackChunkcelestia_docs||[]).push([[394],{3905:function(t,e,n){n.d(e,{Zo:function(){return u},kt:function(){return d}});var r=n(7294);function a(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function o(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function c(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?o(Object(n),!0).forEach((function(e){a(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function i(t,e){if(null==t)return{};var n,r,a=function(t,e){if(null==t)return{};var n,r,a={},o=Object.keys(t);for(r=0;r<o.length;r++)n=o[r],e.indexOf(n)>=0||(a[n]=t[n]);return a}(t,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(r=0;r<o.length;r++)n=o[r],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(a[n]=t[n])}return a}var s=r.createContext({}),l=function(t){var e=r.useContext(s),n=e;return t&&(n="function"==typeof t?t(e):c(c({},e),t)),n},u=function(t){var e=l(t.components);return r.createElement(s.Provider,{value:e},t.children)},p={inlineCode:"code",wrapper:function(t){var e=t.children;return r.createElement(r.Fragment,{},e)}},m=r.forwardRef((function(t,e){var n=t.components,a=t.mdxType,o=t.originalType,s=t.parentName,u=i(t,["components","mdxType","originalType","parentName"]),m=l(n),d=a,f=m["".concat(s,".").concat(d)]||m[d]||p[d]||o;return n?r.createElement(f,c(c({ref:e},u),{},{components:n})):r.createElement(f,c({ref:e},u))}));function d(t,e){var n=arguments,a=e&&e.mdxType;if("string"==typeof t||a){var o=n.length,c=new Array(o);c[0]=m;var i={};for(var s in e)hasOwnProperty.call(e,s)&&(i[s]=e[s]);i.originalType=t,i.mdxType="string"==typeof t?t:a,c[1]=i;for(var l=2;l<o;l++)c[l]=n[l];return r.createElement.apply(null,c)}return r.createElement.apply(null,n)}m.displayName="MDXCreateElement"},749:function(t,e,n){n.r(e),n.d(e,{assets:function(){return s},contentTitle:function(){return c},default:function(){return p},frontMatter:function(){return o},metadata:function(){return i},toc:function(){return l}});var r=n(3117),a=(n(7294),n(3905));const o={sidebar_label:"Contract Interaction"},c="Contract Interaction on CosmWasm with Celestia",i={unversionedId:"developers/cosmwasm-contract-interaction",id:"developers/cosmwasm-contract-interaction",title:"Contract Interaction on CosmWasm with Celestia",description:"In the previous steps, you have stored out contract's tx hash in an",source:"@site/docs/developers/cosmwasm-contract-interaction.md",sourceDirName:"developers",slug:"/developers/cosmwasm-contract-interaction",permalink:"/pr-preview/pr-277/fr/developers/cosmwasm-contract-interaction",draft:!1,editUrl:"https://github.com/celestiaorg/docs/tree/main/docs/developers/cosmwasm-contract-interaction.md",tags:[],version:"current",frontMatter:{sidebar_label:"Contract Interaction"},sidebar:"developers",previous:{title:"Contract Deployment",permalink:"/pr-preview/pr-277/fr/developers/cosmwasm-contract-deployment"},next:{title:"CosmWasm Resources",permalink:"/pr-preview/pr-277/fr/developers/cosmwasm-resources"}},s={},l=[{value:"Contract Querying",id:"contract-querying",level:2},{value:"Contract Instantiation",id:"contract-instantiation",level:2},{value:"Contract Interaction",id:"contract-interaction",level:2}],u={toc:l};function p(t){let{components:e,...n}=t;return(0,a.kt)("wrapper",(0,r.Z)({},u,n,{components:e,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"contract-interaction-on-cosmwasm-with-celestia"},"Contract Interaction on CosmWasm with Celestia"),(0,a.kt)("p",null,"In the previous steps, you have stored out contract's tx hash in an\nenvironment variable for later use."),(0,a.kt)("p",null,"Because of the longer time periods of submitting transactions via Rollmint\ndue to waiting on Celestia's Data Availability Layer to confirm block inclusion,\nyou will need to query your  tx hash directly to get information about it."),(0,a.kt)("h2",{id:"contract-querying"},"Contract Querying"),(0,a.kt)("p",null,"Let's start by querying your transaction hash for its code ID:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-sh"},"CODE_ID=$(wasmd query tx --type=hash $TX_HASH $NODE --output json | jq -r '.logs[0].events[-1].attributes[0].value')\necho $CODE_ID\n")),(0,a.kt)("p",null,"This will give us back the Code ID of the deployed contract."),(0,a.kt)("p",null,"In your case, since it's the first contract deployed on your local network,\nthe value is ",(0,a.kt)("inlineCode",{parentName:"p"},"1"),"."),(0,a.kt)("p",null,"Now, you can take a look at the contracts instantiated by this Code ID:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-sh"},"wasmd query wasm list-contract-by-code $CODE_ID $NODE --output json\n")),(0,a.kt)("p",null,"You get the following output:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-json"},'{"contracts":[],"pagination":{"next_key":null,"total":"0"}}\n')),(0,a.kt)("h2",{id:"contract-instantiation"},"Contract Instantiation"),(0,a.kt)("p",null,"You start instantiating the contract by writing up the following ",(0,a.kt)("inlineCode",{parentName:"p"},"INIT")," message\nfor nameservice contract. Here, you are specifying that ",(0,a.kt)("inlineCode",{parentName:"p"},"purchase_price")," of a name\nis ",(0,a.kt)("inlineCode",{parentName:"p"},"100uwasm")," and ",(0,a.kt)("inlineCode",{parentName:"p"},"transfer_price")," is ",(0,a.kt)("inlineCode",{parentName:"p"},"999uwasm"),"."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-sh"},'INIT=\'{"purchase_price":{"amount":"100","denom":"uwasm"},"transfer_price":{"amount":"999","denom":"uwasm"}}\'\nwasmd tx wasm instantiate $CODE_ID "$INIT" --from $KEY_NAME --keyring-backend test --label "name service" $TXFLAG -y --no-admin\n')),(0,a.kt)("h2",{id:"contract-interaction"},"Contract Interaction"),(0,a.kt)("p",null,"Now that you instantiated it, you can interact further with the contract:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-sh"},"wasmd query wasm list-contract-by-code $CODE_ID $NODE --output json\nCONTRACT=$(wasmd query wasm list-contract-by-code $CODE_ID $NODE --output json | jq -r '.contracts[-1]')\necho $CONTRACT\n\nwasmd query wasm contract $CONTRACT $NODE\nwasmd query bank balances $CONTRACT $NODE\n")),(0,a.kt)("p",null,"This allows us to see the contract address, contract details, and\nbank balances."),(0,a.kt)("p",null,"Now, let's register a name to the contract for your wallet address:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-sh"},'REGISTER=\'{"register":{"name":"fred"}}\'\nwasmd tx wasm execute $CONTRACT "$REGISTER" --amount 100uwasm --from $KEY_NAME $TXFLAG -y\n\n# Query the owner of the name record\nNAME_QUERY=\'{"resolve_record": {"name": "fred"}}\'\nwasmd query wasm contract-state smart $CONTRACT "$NAME_QUERY" $NODE --output json\n')),(0,a.kt)("p",null,"With that, you have instantiated and interacted with the CosmWasm nameservice\nsmart contract using Celestia!"))}p.isMDXComponent=!0}}]);